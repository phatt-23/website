import{T as He,v as D,w as Ve,m as k,ac as Ge,V as qe,W as Be,X as pe,E as ee,Y as te,z as G,C as We,aS as $e,_ as de,a2 as Je,a0 as z,aw as me,Z as Ne,a6 as Ye,au as Ie,aP as xe,aK as Ae,b0 as Z,a3 as Oe,a4 as Ke,b1 as Q,b2 as Ze,b3 as se,aE as Re,A as Qe,b4 as je,aO as et,b5 as tt,x as st,G as nt,b6 as De,q as rt,b7 as at,b8 as he,e as it,a7 as lt,b9 as ot,ba as ct,as as ut,u as Pe,g as Fe,bb as dt,p as ft,f as j,d as x,s as M,K as vt,r as A,L as ht,t as ne,M as _t,b as H,c as gt,an as Ee,a as Y,ap as pt,j as mt}from"./0h0eovDe.js";import"./DsnmJJEf.js";import{d as It,s as re,b as Et,o as yt,w as K,g as ye,c as St}from"./BeBJMhcX.js";import{p as ae,i as ie}from"./E6MyXn9j.js";import{h as Se}from"./Bp5AzgID.js";import{r as wt}from"./CSnGU0Cu.js";function Ct(e,t){return t}function bt(e,t,n){for(var s=e.items,r=[],a=t.length,i=0;i<a;i++)je(t[i].e,r,!0);var l=a>0&&r.length===0&&n!==null;if(l){var g=n.parentNode;et(g),g.append(n),s.clear(),L(e,t[0].prev,t[a-1].next)}tt(r,()=>{for(var d=0;d<a;d++){var u=t[d];l||(s.delete(u.k),L(e,u.prev,u.next)),Re(u.e,!l)}})}function Nt(e,t,n,s,r,a=null){var i=e,l={flags:t,items:new Map,first:null},g=(t&De)!==0;if(g){var d=e;i=D?ee(nt(d)):d.appendChild(Ne())}D&&Ve();var u=null,S=!1,v=new Map,y=Ge(()=>{var m=n();return Ae(m)?m:m==null?[]:xe(m)}),o,f;function _(){xt(f,o,l,v,i,r,t,s,n),a!==null&&(o.length===0?u?Oe(u):u=de(()=>a(i)):u!==null&&Ke(u,()=>{u=null}))}He(()=>{f??=st,o=k(y);var m=o.length;if(S&&m===0)return;S=m===0;let C=!1;if(D){var O=qe(i)===Be;O!==(m===0)&&(i=pe(),ee(i),te(!1),C=!0)}if(D){for(var w=null,I,c=0;c<m;c++){if(G.nodeType===We&&G.data===$e){i=G,C=!0,te(!1);break}var h=o[c],E=s(h,c);I=fe(G,l,w,null,h,E,c,r,t,n),l.items.set(E,I),w=I}m>0&&ee(pe())}if(D)m===0&&a&&(u=de(()=>a(i)));else if(Je()){var F=new Set,T=z;for(c=0;c<m;c+=1){h=o[c],E=s(h,c);var b=l.items.get(E)??v.get(E);b?(t&(Q|Z))!==0&&Te(b,h,c,t):(I=fe(null,l,null,null,h,E,c,r,t,n,!0),v.set(E,I)),F.add(E)}for(const[N,R]of l.items)F.has(N)||T.skipped_effects.add(R.e);T.add_callback(_)}else _();C&&te(!0),k(y)}),D&&(i=G)}function xt(e,t,n,s,r,a,i,l,g){var d=(i&at)!==0,u=(i&(Q|Z))!==0,S=t.length,v=n.items,y=n.first,o=y,f,_=null,m,C=[],O=[],w,I,c,h;if(d)for(h=0;h<S;h+=1)w=t[h],I=l(w,h),c=v.get(I),c!==void 0&&(c.a?.measure(),(m??=new Set).add(c));for(h=0;h<S;h+=1){if(w=t[h],I=l(w,h),c=v.get(I),c===void 0){var E=s.get(I);if(E!==void 0){s.delete(I),v.set(I,E);var F=_?_.next:o;L(n,_,E),L(n,E,F),le(E,F,r),_=E}else{var T=o?o.e.nodes_start:r;_=fe(T,n,_,_===null?n.first:_.next,w,I,h,a,i,g)}v.set(I,_),C=[],O=[],o=_.next;continue}if(u&&Te(c,w,h,i),(c.e.f&se)!==0&&(Oe(c.e),d&&(c.a?.unfix(),(m??=new Set).delete(c))),c!==o){if(f!==void 0&&f.has(c)){if(C.length<O.length){var b=O[0],N;_=b.prev;var R=C[0],X=C[C.length-1];for(N=0;N<C.length;N+=1)le(C[N],b,r);for(N=0;N<O.length;N+=1)f.delete(O[N]);L(n,R.prev,X.next),L(n,_,R),L(n,X,b),o=b,_=X,h-=1,C=[],O=[]}else f.delete(c),le(c,o,r),L(n,c.prev,c.next),L(n,c,_===null?n.first:_.next),L(n,_,c),_=c;continue}for(C=[],O=[];o!==null&&o.k!==I;)(o.e.f&se)===0&&(f??=new Set).add(o),O.push(o),o=o.next;if(o===null)continue;c=o}C.push(c),_=c,o=c.next}if(o!==null||f!==void 0){for(var U=f===void 0?[]:xe(f);o!==null;)(o.e.f&se)===0&&U.push(o),o=o.next;var J=U.length;if(J>0){var Ue=(i&De)!==0&&S===0?r:null;if(d){for(h=0;h<J;h+=1)U[h].a?.measure();for(h=0;h<J;h+=1)U[h].a?.fix()}bt(n,U,Ue)}}d&&rt(()=>{if(m!==void 0)for(c of m)c.a?.apply()}),e.first=n.first&&n.first.e,e.last=_&&_.e;for(var ze of s.values())Re(ze.e);s.clear()}function Te(e,t,n,s){(s&Q)!==0&&me(e.v,t),(s&Z)!==0?me(e.i,n):e.i=n}function fe(e,t,n,s,r,a,i,l,g,d,u){var S=(g&Q)!==0,v=(g&Ze)===0,y=S?v?Ye(r,!1,!1):Ie(r):r,o=(g&Z)===0?i:Ie(i),f={i:o,v:y,k:a,a:null,e:null,prev:n,next:s};try{if(e===null){var _=document.createDocumentFragment();_.append(e=Ne())}return f.e=de(()=>l(e,y,o,d),D),f.e.prev=n&&n.e,f.e.next=s&&s.e,n===null?u||(t.first=f):(n.next=f,n.e.next=f.e),s!==null&&(s.prev=f,s.e.prev=f.e),f}finally{}}function le(e,t,n){for(var s=e.next?e.next.e.nodes_start:n,r=t?t.e.nodes_start:n,a=e.e.nodes_start;a!==null&&a!==s;){var i=Qe(a);r.before(a),a=i}}function L(e,t,n){t===null?e.first=n:(t.next=n,t.e.next=n&&n.e),n!==null&&(n.prev=t,n.e.prev=t&&t.e)}function Le(e){var t,n,s="";if(typeof e=="string"||typeof e=="number")s+=e;else if(typeof e=="object")if(Array.isArray(e)){var r=e.length;for(t=0;t<r;t++)e[t]&&(n=Le(e[t]))&&(s&&(s+=" "),s+=n)}else for(n in e)e[n]&&(s&&(s+=" "),s+=n);return s}function At(){for(var e,t,n=0,s="",r=arguments.length;n<r;n++)(e=arguments[n])&&(t=Le(e))&&(s&&(s+=" "),s+=t);return s}function jt(e){return typeof e=="object"?At(e):e??""}const we=[...` 	
\r\fÂ \v\uFEFF`];function es(e,t,n){var s=e==null?"":""+e;if(t&&(s=s?s+" "+t:t),n){for(var r in n)if(n[r])s=s?s+" "+r:r;else if(s.length)for(var a=r.length,i=0;(i=s.indexOf(r,i))>=0;){var l=i+a;(i===0||we.includes(s[i-1]))&&(l===s.length||we.includes(s[l]))?s=(i===0?"":s.substring(0,i))+s.substring(l+1):i=l}}return s===""?null:s}function Ot(e,t){return e==null?null:String(e)}function Rt(e,t,n,s){var r=e.__style;if(D||r!==t){var a=Ot(t);(!D||a!==e.getAttribute("style"))&&(a==null?e.removeAttribute("style"):e.style.cssText=a),e.__style=t}return s}function Me(e,t,n=!1){if(e.multiple){if(t==null)return;if(!Ae(t))return ot();for(var s of e.options)s.selected=t.includes(q(s));return}for(s of e.options){var r=q(s);if(ct(r,t)){s.selected=!0;return}}(!n||t!==void 0)&&(e.selectedIndex=-1)}function Dt(e){var t=new MutationObserver(()=>{Me(e,e.__value)});t.observe(e,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),lt(()=>{t.disconnect()})}function ts(e,t,n=t){var s=!0;he(e,"change",r=>{var a=r?"[selected]":":checked",i;if(e.multiple)i=[].map.call(e.querySelectorAll(a),q);else{var l=e.querySelector(a)??e.querySelector("option:not([disabled])");i=l&&q(l)}n(i)}),it(()=>{var r=t();if(Me(e,r,s),s&&r===void 0){var a=e.querySelector(":checked");a!==null&&(r=q(a),n(r))}e.__value=r,s=!1}),Dt(e)}function q(e){return"__value"in e?e.__value:e.value}function ss(e,t,n=t){var s=new WeakSet;he(e,"input",async r=>{var a=r?e.defaultValue:e.value;if(a=oe(e)?ce(a):a,n(a),z!==null&&s.add(z),await ut(),a!==(a=t())){var i=e.selectionStart,l=e.selectionEnd;e.value=a??"",l!==null&&(e.selectionStart=i,e.selectionEnd=Math.min(l,e.value.length))}}),(D&&e.defaultValue!==e.value||Pe(t)==null&&e.value)&&(n(oe(e)?ce(e.value):e.value),z!==null&&s.add(z)),Fe(()=>{var r=t();if(e===document.activeElement){var a=dt??z;if(s.has(a))return}oe(e)&&r===ce(e.value)||e.type==="date"&&!r&&!e.value||r!==e.value&&(e.value=r??"")})}function Pt(e,t,n=t){he(e,"change",s=>{var r=s?e.defaultChecked:e.checked;n(r)}),(D&&e.defaultChecked!==e.checked||Pe(t)==null)&&n(e.checked),Fe(()=>{var s=t();e.checked=!!s})}function oe(e){var t=e.type;return t==="number"||t==="range"}function ce(e){return e===""?null:+e}const Ft="unsolvable";class Tt extends Error{}function _e(e,t){if(!e)throw new Tt("[ASSERT] "+t)}function ke(e,t,n){return n.indexOf(e)===t}const Lt=":",P="n:",ue="e:",ns="n%:",rs="source",as="target",is="n%c:",ls="n%i:",os="n%t:",cs="n%f:",us="T:",ds="F:",fs="filler1:",vs="filler2:",hs={CORE:{T:P+"T",F:P+"F",B:P+"B"},TRUE_VAR_NODE_PREFIX:"nvt:",FALSE_VAR_NODE_PREFIX:"nvf:",CLAUSE_NODE_PREFIX:"nc:",COLOR_TRUE:1,COLOR_FALSE:0,COLOR_BUFFER:2},Ce={CLAUSE_PREFIX:"c:",VAR_PREFIX:"v:"},_s={INCOMING_NODE_PREFIX:"nin:",GAP_NODE_PREFIX:"ngap:",OUTGOING_NODE_PREFIX:"nout:"},gs=e=>e.startsWith(P)?e.slice(P.length):e;class p{static SerializableClass(t){return function(n){const s=t??n.name;n.prototype.__type=s,p.registerClass(s,n)}}static serialize(t){if(t==null)return t;if(Array.isArray(t))return t.map(p.serialize);if(t instanceof Set)return{__type:"Set",values:Array.from(t).map(p.serialize)};if(t instanceof Map)return{__type:"Map",entries:Array.from(t.entries()).map(([n,s])=>[p.serialize(n),p.serialize(s)])};if(typeof t=="object"){if(Array.isArray(t))return t.map(p.serialize);const n=t.constructor,r={__type:t.__type??n.name};for(const[a,i]of Object.entries(t))r[a]=p.serialize(i);return r}return t}static revive(t){if(t==null)return t;if(Array.isArray(t))return t.map(p.revive);if(t.__type==="Set")return new Set(t.values.map(p.revive));if(t.__type==="Map")return new Map(t.entries.map(([n,s])=>[p.revive(n),p.revive(s)]));if(t.__type){const n=p.getClass(t.__type);if(!n)throw new Error(`Serializer - Unknown class: ${t.__type}`);const s=Object.create(n.prototype);for(const[r,a]of Object.entries(t))r!=="__type"&&(s[r]=p.revive(a));return s}return t}static registerClass(t,n){p.classRegistry.set(t,n)}static getClass(t){return p.classRegistry.get(t)}static classRegistry=new Map}p.registerClass(Object.name,Object);class Xe{}var Mt=Object.getOwnPropertyDescriptor,ge=(e,t,n,s)=>{for(var r=s>1?void 0:s?Mt(t,n):t,a=e.length-1,i;a>=0;a--)(i=e[a])&&(r=i(r)||r);return r};let B=class{id;varName;negated;constructor(e,t,n=!1){this.id=e,this.varName=t,this.negated=n}toJson(){return{__type:B.name,id:this.id,varName:this.varName,negated:this.negated}}asString(){return`${this.negated?"!":""}${this.varName}`}asHtmlString(){return(this.negated?"&not;":"")+this.varName}};B=ge([p.SerializableClass("Literal")],B);let W=class{id;literals;constructor(e,t){_e(t.length==3),this.id=e,this.literals=[t[0],t[1],t[2]]}asString(){return this.literals.map(e=>e.asString()).join(" ")}asHtmlString(){return"("+this.literals.map(t=>t.asHtmlString()).join("&or;")+")"}toJSON(){return{__type:W.name,id:this.id,literals:this.literals}}};W=ge([p.SerializableClass("Clause")],W);let $=class extends Xe{_variables=new Set;_clauses=new Set;addVariable(e){this._variables.add(e)}addClause(e){this._clauses.add(e),e.literals.forEach(t=>this.addVariable(t.varName))}asString(){return Array.from(this._clauses.values()).map(e=>e.asString()).join(`
`)}asHtmlString(){return this.clauses.map(e=>e.asHtmlString()).join("&and;")}get variables(){return Array.from(this._variables.values())}get clauses(){return Array.from(this._clauses.values())}isEmpty(){const e=this.clauses.length==0||this.variables.length==0;return console.debug("empty",e),e}static fromString(e){const t=e.split(`
`).map(s=>s.trim()).filter(s=>s.length).filter(ke);let n=new $;for(let s=0;s<t.length;s++){const r=t[s],a=r.split(" ").map(d=>d.trim()).filter(d=>d.length);if(a.length!=3)return`Clause number ${s+1} (${r}) doesn't have exactly 3 literals.Instead it has ${a.length} literals.`;const i=Ce.CLAUSE_PREFIX+s;let l=[];for(let d=0;d<a.length;d++){let u=a[d];const S=u.startsWith("!");if(S&&(u=u.replace("!","")),u.includes("!")||u.includes("||")||u.includes("&&"))return`Literal ${S?"!":""}${u} is invalid.`;const v=Ce.VAR_PREFIX+d,y=new B(`${v}-${i}`,u,S);l.push(y)}_e(l.length==3);const g=new W(i,l);n.addClause(g)}return n}copy(){const e=new $;return this._variables.forEach(t=>e.addVariable(t)),this._clauses.forEach(t=>{const n=t.literals.map(r=>new B(r.id,r.varName,r.negated)),s=new W(t.id,n);e.addClause(s)}),e}toSerializedString(){throw"Not implemented"}static fromSerializedString(e){throw"Not implemented"}};$=ge([p.SerializableClass("CNF3")],$);var kt=Object.getOwnPropertyDescriptor,Xt=(e,t,n,s)=>{for(var r=s>1?void 0:s?kt(t,n):t,a=e.length-1,i;a>=0;a--)(i=e[a])&&(r=i(r)||r);return r};let V=class extends Xe{_nodes;_edges;constructor(){super(),this._nodes=new Set,this._edges=new Set}addNode(e){e.classes==null&&(e.classes=""),!this.nodes.find(t=>t.id==e.id)&&this._nodes.add(e)}addEdge(e){e.classes==null&&(e.classes=""),e.controlPointDistances==null&&(e.controlPointDistances=[0,0]),_e(e.controlPointDistances.length==2,"There must be 2 control points."),!this.edges.find(t=>t.id==e.id)&&this._edges.add(e)}get nodes(){return Array.from(this._nodes.values())}get edges(){return Array.from(this._edges.values())}removeNode(e){if(!this._nodes.has(e))return;this._nodes.delete(e),Array.from(this.edges).filter(n=>n.to===e.id||n.from===e.id).forEach(n=>this._edges.delete(n))}removeEdge(e){this._edges.delete(e)}removeEdgeById(e){const t=this.edges.find(n=>n.id==e);t?(console.log("deleting edge with id",e),this._edges.delete(t)):console.log("edge with id",e,"not found")}isEmpty(){return this.nodes.length==0}copy(){const e=new V;for(const t of this._nodes)e.addNode({id:t.id,label:t.label,color:t.color,position:t.position?{...t.position}:void 0,classes:t.classes});for(const t of this._edges)e.addEdge({id:t.id,from:t.from,to:t.to,weight:t.weight,classes:t.classes,controlPointDistances:t.controlPointDistances});return e}asString(){const e=this.nodes.map(n=>n.id.slice(P.length)).join(`
`),t=this.edges.map(n=>n.from.slice(P.length)+" "+n.to.slice(P.length)+(n.weight!=null?" "+n.weight:"")).join(`
`);return e+`
`+t+`
`}static fromString(e){if(e.length==0)return"Cannot construct a graph from empty string";const t=e.split(`
`).map(s=>s.trim()).filter(s=>s.length).filter(ke);let n=new V;console.debug("LINES",t);for(let s=0;s<t.length;s++){const a=t[s].split(" ").map(i=>i.trim()).filter(i=>i.length);if(a.length==1){const i=a;n.addNode({id:P+i})}else if(a.length<=3){const i=a[0],l=a[1];let g;if(a.length==3)try{g=Number.parseFloat(a[2])}catch{return`On the line ${s}, couldn't parse the weight: '${a[2]}Please enter a number (floating allowed)`}const d=P+i,u=P+l;n.addNode({id:d}),n.addNode({id:u}),n.addEdge({id:ue+`${d}-${u}`,from:d,to:u,weight:g})}}return n}toSerializedString(){const e={nodes:this.nodes.map(t=>({id:t.id,label:t.label??null,color:t.color??null,position:t.position??null,classes:t.classes??""})),edges:this.edges.map(t=>({id:t.id,from:t.from,to:t.to,weight:t.weight??null,classes:t.classes??"",controlPointDistances:t.controlPointDistances??[0,0]}))};return JSON.stringify(e,null)}static fromSerializedString(e){const t=JSON.parse(e),n=new V;if(Array.isArray(t.nodes))for(const s of t.nodes)n.addNode({id:s.id,label:s.label??void 0,color:s.color??void 0,position:s.position??void 0,classes:s.classes??""});if(Array.isArray(t.edges))for(const s of t.edges)n.addEdge({id:s.id,from:s.from,to:s.to,weight:s.weight??void 0,classes:s.classes??"",controlPointDistances:s.controlPointDistances??[0,0]});return n}labelSolved({path:e=[],directed:t=!1,edgeIdUsesNodeIds:n=!0}={}){console.debug("edgeIdUsesNodeIds",n);const s=n?(r=>r):(r=>r.slice(r.search(Lt)+1));this.edges.forEach(r=>r.classes+=" solved");for(let r=0;r<e.length-1;r++){const a=s(e[r].id),i=s(e[r+1].id),l=ue+`${a}-${i}`,g=ue+`${i}-${a}`,d=this.edges.find(u=>u.id==l||!t&&u.id==g);console.debug("edgeId",l,"edgeIdMirror",g,"edge found",d!=null),d&&(d.classes+=" used")}}unlabelSolved(){this._edges.forEach(e=>{e.classes&&(e.classes=e.classes.replaceAll("used",""),e.classes=e.classes.replaceAll("solved",""))})}};V=Xt([p.SerializableClass()],V);class ve{static cnf3TextInput={NO_SOLUTION:`x y z
!x y z
x !y z
!x !y z
x y !z
!x y !z
x !y !z
!x !y !z
`,BASIC:`x y z
a b c
`};static graphTextInput={CYCLE:`0 1
1 2
2 3
3 4
4 0
`,PATH:`0 1
1 2
2 3
3 4
`,COMPLETE:`0 1
1 2
2 3
3 4
0 2
0 3
0 4
1 3
1 4
2 4
`};static getTextInputs(t){if(t===$)return ve.cnf3TextInput;if(t===V)return ve.graphTextInput;throw new Error(`No demos provided for class ${t.name}.`)}}function Ut(e,t,n){t()&&n.stepIndex>0&&t()()}function zt(e,t,n,s){t()&&n.stepIndex<s-1&&t()()}var Ht=j("<h3> </h3> <p><!></p> <!>",1),Vt=j("<h3> </h3> <p><!></p>",1),Gt=j('<section><div class="header svelte-bomf3d"><h2>Reduction Stepper</h2> <div class="controls"><div><input type="checkbox" name="showAllCheckbox"/> <label for="showAllCheckbox">Show all</label></div> <div><button>Previous</button> <button>Next</button> <span> </span></div></div></div> <!></section>');function ps(e,t){ft(t,!0);let n=ae(t,"indent",3,0),s=ae(t,"onNextClick",3,void 0),r=ae(t,"onPrevClick",3,void 0);const a=t.steps.length;let i=ht(!1);var l=Gt(),g=x(l),d=M(x(g),2),u=x(d),S=x(u);wt(S),vt(2),A(u);var v=M(u,2),y=x(v);y.__click=[Ut,r,t];var o=M(y,2);o.__click=[zt,s,t,a];var f=M(o,2),_=x(f);A(f),A(v),A(d),A(g);var m=M(g,2);{var C=w=>{var I=Ee(),c=Y(I);Nt(c,17,()=>t.steps,Ct,(h,E,F)=>{var T=Ht(),b=Y(T),N=x(b);A(b);var R=M(b,2),X=x(R);Se(X,()=>k(E).description),A(R);var U=M(R,2);ie(U,J=>{}),ne(()=>re(N,`Step #${F+1}: ${k(E).title??""}`)),H(h,T)}),H(w,I)},O=w=>{var I=Ee(),c=Y(I);{var h=E=>{const F=pt(()=>t.steps[t.stepIndex]);var T=Vt(),b=Y(T),N=x(b);A(b);var R=M(b,2),X=x(R);Se(X,()=>k(F).description),A(R),ne(()=>re(N,`Step #${t.stepIndex+1}: ${k(F).title??""}`)),H(E,T)};ie(c,E=>{t.stepIndex<t.steps.length&&E(h)})}H(w,I)};ie(m,w=>{k(i)?w(C):w(O,!1)})}A(l),ne(()=>{Rt(l,`padding-left: ${n()*100}px; border: solid black 1px`),re(_,`${t.stepIndex+1}/${a??""}`)}),Pt(S,()=>k(i),w=>_t(i,w)),H(e,l),gt()}It(["click"]);var qt=j('<main><div class="loading svelte-nrcxd8"><span class="spinner svelte-nrcxd8"></span> <span><!></span></div></main>');function ms(e,t){var n=qt(),s=x(n),r=M(x(s),2),a=x(r);Et(a,()=>t.children),A(r),A(s),A(n),H(e,n)}function Is(e,t,n={serialize:s=>p.serialize(s),revive:s=>p.revive(s)}){let s=K(t);yt(()=>{const a=localStorage.getItem(e);if(a){const i=n.revive(JSON.parse(a));s.set(i)}});const r=()=>{if(ye(s)){const a=JSON.stringify(n.serialize(ye(s)));localStorage.setItem(e,a)}else localStorage.removeItem(e)};return{value:s,save:()=>r()}}function Es(e){let t=e.storage.value,n=K(!1),s=K(!1),r=K(""),a=null,i=null,l=null,g=!1;t.subscribe(v=>{g=v.hasOutCertificate(),i=v.inInstance,l=v.outInstance});function d(v){console.debug("editorChanged"),a&&(a.terminate(),a=null,s.set(!1),r.set("Solving cancelled.")),t.update(y=>(y.reset(),y.setInInstance(v),y)),e.storage.save()}function u(){if(!i||i.isEmpty())return;const v=e.reducerFactory(i),{outInstance:y,steps:o}=v.reduce();t.update(f=>(f.setSteps(o),f.setOutInstance(y),f)),e.storage.save()}async function S(){if(!e.workerUrl)throw"Worker URL not provided";if(!l)throw"Output instance is not set";if(g)throw"Reduction storage already has certificate of the output problem";s.set(!0),r.set("Solving..."),a&&a.terminate();const v=new Worker(e.workerUrl,{type:"module"});a=v;const y=e.createWorkerMessage?.(l)??l.toSerializedString();v.postMessage(y);try{const o=await new Promise((f,_)=>{v.onmessage=m=>f(m.data),v.onerror=m=>_(m)});t.update(f=>{if(f.outCert=o,o!=Ft){const _=e.decoderFactory();f.inCert=_.decode(f.outInstance,o)}return f}),e.onSolveFinished?.(l,o),e.storage.save()}catch(o){console.debug(`Error occured while solving: ${o}`),r.set(`Error occured while solving: ${o}`)}finally{r.set(""),s.set(!1),v.terminate(),a=null}}return St(()=>{a&&(a.terminate(),a=null)}),mt(()=>{t.update(v=>(v.resetStepIndex(),v))}),{redStore:t,showStepper:n,isSolving:s,solveMessage:r,editorChanged:d,reduce:u,solve:S}}class ys{constructor(t){this.inInstance=t}reduce(){if(this.inInstance.isEmpty())throw"Call to reduce failed. Input instance is empty.";return this.doReduce()}}var Bt=Object.getOwnPropertyDescriptor,Wt=(e,t,n,s)=>{for(var r=s>1?void 0:s?Bt(t,n):t,a=e.length-1,i;a>=0;a--)(i=e[a])&&(r=i(r)||r);return r};let be=class{inInstance=null;outInstance=null;steps=[];stepIndex=0;inCert=null;outCert=null;reset(){this.inInstance=null,this.outInstance=null,this.inCert=null,this.outCert=null,this.steps=[],this.stepIndex=0}resetStepIndex(){this.stepIndex=0}setInInstance(e){this.reset(),this.inInstance=e}setOutInstance(e){this.outInstance=e}setSteps(e){this.steps=e,this.stepIndex=0}nextStep(){const e=this.steps.length;this.stepIndex=Math.min(this.stepIndex+1,e)}prevStep(){this.stepIndex=Math.max(this.stepIndex-1,0)}hasInstances(){return this.inInstance!=null&&this.outInstance!=null}hasInInstance(){return this.inInstance!=null}hasOutInstance(){return this.outInstance!=null}hasInCertificate(){return this.inCert!=null}hasOutCertificate(){return this.outCert!=null}};be=Wt([p.SerializableClass("ReductionStore")],be);export{$ as C,ve as D,ue as E,V as G,_s as H,P as N,Xe as P,ys as R,p as S,as as T,Ft as U,us as V,be as a,Pt as b,Es as c,ms as d,Nt as e,ps as f,ss as g,ts as h,Ct as i,gs as j,os as k,cs as l,is as m,ns as n,rs as o,ls as p,hs as q,_e as r,Ce as s,es as t,Is as u,jt as v,ds as w,fs as x,vs as y};
