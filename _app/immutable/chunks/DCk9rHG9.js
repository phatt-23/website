import{T as He,v as D,w as Ve,m as M,ac as Ge,V as We,W as qe,X as pe,E as ee,Y as te,z as G,C as Be,aS as $e,_ as de,a2 as Je,a0 as z,aw as me,Z as Ne,a6 as Ye,au as Ie,aP as Oe,aK as xe,b0 as Z,a3 as Ae,a4 as Ke,b1 as Q,b2 as Ze,b3 as se,aE as Re,A as Qe,b4 as je,aO as et,b5 as tt,x as st,G as nt,b6 as De,q as rt,b7 as at,b8 as he,e as it,a7 as lt,b9 as ot,ba as ct,as as ut,u as Pe,g as Fe,bb as dt,p as ft,f as j,d as O,s as k,K as vt,r as x,L as ht,t as ne,M as _t,b as H,c as gt,an as Ee,a as Y,ap as pt,j as mt}from"./0h0eovDe.js";import"./DsnmJJEf.js";import{d as It,s as re,b as Et,o as wt,w as K,g as we,c as bt}from"./BeBJMhcX.js";import{p as ae,i as ie}from"./E6MyXn9j.js";import{h as be}from"./Bp5AzgID.js";import{r as yt}from"./CSnGU0Cu.js";function St(e,t){return t}function Ct(e,t,n){for(var s=e.items,r=[],a=t.length,i=0;i<a;i++)je(t[i].e,r,!0);var l=a>0&&r.length===0&&n!==null;if(l){var g=n.parentNode;et(g),g.append(n),s.clear(),L(e,t[0].prev,t[a-1].next)}tt(r,()=>{for(var d=0;d<a;d++){var u=t[d];l||(s.delete(u.k),L(e,u.prev,u.next)),Re(u.e,!l)}})}function Nt(e,t,n,s,r,a=null){var i=e,l={flags:t,items:new Map,first:null},g=(t&De)!==0;if(g){var d=e;i=D?ee(nt(d)):d.appendChild(Ne())}D&&Ve();var u=null,b=!1,v=new Map,w=Ge(()=>{var m=n();return xe(m)?m:m==null?[]:Oe(m)}),o,f;function _(){Ot(f,o,l,v,i,r,t,s,n),a!==null&&(o.length===0?u?Ae(u):u=de(()=>a(i)):u!==null&&Ke(u,()=>{u=null}))}He(()=>{f??=st,o=M(w);var m=o.length;if(b&&m===0)return;b=m===0;let S=!1;if(D){var A=We(i)===qe;A!==(m===0)&&(i=pe(),ee(i),te(!1),S=!0)}if(D){for(var y=null,I,c=0;c<m;c++){if(G.nodeType===Be&&G.data===$e){i=G,S=!0,te(!1);break}var h=o[c],E=s(h,c);I=fe(G,l,y,null,h,E,c,r,t,n),l.items.set(E,I),y=I}m>0&&ee(pe())}if(D)m===0&&a&&(u=de(()=>a(i)));else if(Je()){var F=new Set,T=z;for(c=0;c<m;c+=1){h=o[c],E=s(h,c);var C=l.items.get(E)??v.get(E);C?(t&(Q|Z))!==0&&Te(C,h,c,t):(I=fe(null,l,null,null,h,E,c,r,t,n,!0),v.set(E,I)),F.add(E)}for(const[N,R]of l.items)F.has(N)||T.skipped_effects.add(R.e);T.add_callback(_)}else _();S&&te(!0),M(w)}),D&&(i=G)}function Ot(e,t,n,s,r,a,i,l,g){var d=(i&at)!==0,u=(i&(Q|Z))!==0,b=t.length,v=n.items,w=n.first,o=w,f,_=null,m,S=[],A=[],y,I,c,h;if(d)for(h=0;h<b;h+=1)y=t[h],I=l(y,h),c=v.get(I),c!==void 0&&(c.a?.measure(),(m??=new Set).add(c));for(h=0;h<b;h+=1){if(y=t[h],I=l(y,h),c=v.get(I),c===void 0){var E=s.get(I);if(E!==void 0){s.delete(I),v.set(I,E);var F=_?_.next:o;L(n,_,E),L(n,E,F),le(E,F,r),_=E}else{var T=o?o.e.nodes_start:r;_=fe(T,n,_,_===null?n.first:_.next,y,I,h,a,i,g)}v.set(I,_),S=[],A=[],o=_.next;continue}if(u&&Te(c,y,h,i),(c.e.f&se)!==0&&(Ae(c.e),d&&(c.a?.unfix(),(m??=new Set).delete(c))),c!==o){if(f!==void 0&&f.has(c)){if(S.length<A.length){var C=A[0],N;_=C.prev;var R=S[0],U=S[S.length-1];for(N=0;N<S.length;N+=1)le(S[N],C,r);for(N=0;N<A.length;N+=1)f.delete(A[N]);L(n,R.prev,U.next),L(n,_,R),L(n,U,C),o=C,_=U,h-=1,S=[],A=[]}else f.delete(c),le(c,o,r),L(n,c.prev,c.next),L(n,c,_===null?n.first:_.next),L(n,_,c),_=c;continue}for(S=[],A=[];o!==null&&o.k!==I;)(o.e.f&se)===0&&(f??=new Set).add(o),A.push(o),o=o.next;if(o===null)continue;c=o}S.push(c),_=c,o=c.next}if(o!==null||f!==void 0){for(var X=f===void 0?[]:Oe(f);o!==null;)(o.e.f&se)===0&&X.push(o),o=o.next;var J=X.length;if(J>0){var Xe=(i&De)!==0&&b===0?r:null;if(d){for(h=0;h<J;h+=1)X[h].a?.measure();for(h=0;h<J;h+=1)X[h].a?.fix()}Ct(n,X,Xe)}}d&&rt(()=>{if(m!==void 0)for(c of m)c.a?.apply()}),e.first=n.first&&n.first.e,e.last=_&&_.e;for(var ze of s.values())Re(ze.e);s.clear()}function Te(e,t,n,s){(s&Q)!==0&&me(e.v,t),(s&Z)!==0?me(e.i,n):e.i=n}function fe(e,t,n,s,r,a,i,l,g,d,u){var b=(g&Q)!==0,v=(g&Ze)===0,w=b?v?Ye(r,!1,!1):Ie(r):r,o=(g&Z)===0?i:Ie(i),f={i:o,v:w,k:a,a:null,e:null,prev:n,next:s};try{if(e===null){var _=document.createDocumentFragment();_.append(e=Ne())}return f.e=de(()=>l(e,w,o,d),D),f.e.prev=n&&n.e,f.e.next=s&&s.e,n===null?u||(t.first=f):(n.next=f,n.e.next=f.e),s!==null&&(s.prev=f,s.e.prev=f.e),f}finally{}}function le(e,t,n){for(var s=e.next?e.next.e.nodes_start:n,r=t?t.e.nodes_start:n,a=e.e.nodes_start;a!==null&&a!==s;){var i=Qe(a);r.before(a),a=i}}function L(e,t,n){t===null?e.first=n:(t.next=n,t.e.next=n&&n.e),n!==null&&(n.prev=t,n.e.prev=t&&t.e)}function Le(e){var t,n,s="";if(typeof e=="string"||typeof e=="number")s+=e;else if(typeof e=="object")if(Array.isArray(e)){var r=e.length;for(t=0;t<r;t++)e[t]&&(n=Le(e[t]))&&(s&&(s+=" "),s+=n)}else for(n in e)e[n]&&(s&&(s+=" "),s+=n);return s}function xt(){for(var e,t,n=0,s="",r=arguments.length;n<r;n++)(e=arguments[n])&&(t=Le(e))&&(s&&(s+=" "),s+=t);return s}function jt(e){return typeof e=="object"?xt(e):e??""}const ye=[...` 	
\r\fÂ \v\uFEFF`];function es(e,t,n){var s=e==null?"":""+e;if(t&&(s=s?s+" "+t:t),n){for(var r in n)if(n[r])s=s?s+" "+r:r;else if(s.length)for(var a=r.length,i=0;(i=s.indexOf(r,i))>=0;){var l=i+a;(i===0||ye.includes(s[i-1]))&&(l===s.length||ye.includes(s[l]))?s=(i===0?"":s.substring(0,i))+s.substring(l+1):i=l}}return s===""?null:s}function At(e,t){return e==null?null:String(e)}function Rt(e,t,n,s){var r=e.__style;if(D||r!==t){var a=At(t);(!D||a!==e.getAttribute("style"))&&(a==null?e.removeAttribute("style"):e.style.cssText=a),e.__style=t}return s}function ke(e,t,n=!1){if(e.multiple){if(t==null)return;if(!xe(t))return ot();for(var s of e.options)s.selected=t.includes(W(s));return}for(s of e.options){var r=W(s);if(ct(r,t)){s.selected=!0;return}}(!n||t!==void 0)&&(e.selectedIndex=-1)}function Dt(e){var t=new MutationObserver(()=>{ke(e,e.__value)});t.observe(e,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),lt(()=>{t.disconnect()})}function ts(e,t,n=t){var s=!0;he(e,"change",r=>{var a=r?"[selected]":":checked",i;if(e.multiple)i=[].map.call(e.querySelectorAll(a),W);else{var l=e.querySelector(a)??e.querySelector("option:not([disabled])");i=l&&W(l)}n(i)}),it(()=>{var r=t();if(ke(e,r,s),s&&r===void 0){var a=e.querySelector(":checked");a!==null&&(r=W(a),n(r))}e.__value=r,s=!1}),Dt(e)}function W(e){return"__value"in e?e.__value:e.value}function ss(e,t,n=t){var s=new WeakSet;he(e,"input",async r=>{var a=r?e.defaultValue:e.value;if(a=oe(e)?ce(a):a,n(a),z!==null&&s.add(z),await ut(),a!==(a=t())){var i=e.selectionStart,l=e.selectionEnd;e.value=a??"",l!==null&&(e.selectionStart=i,e.selectionEnd=Math.min(l,e.value.length))}}),(D&&e.defaultValue!==e.value||Pe(t)==null&&e.value)&&(n(oe(e)?ce(e.value):e.value),z!==null&&s.add(z)),Fe(()=>{var r=t();if(e===document.activeElement){var a=dt??z;if(s.has(a))return}oe(e)&&r===ce(e.value)||e.type==="date"&&!r&&!e.value||r!==e.value&&(e.value=r??"")})}function Pt(e,t,n=t){he(e,"change",s=>{var r=s?e.defaultChecked:e.checked;n(r)}),(D&&e.defaultChecked!==e.checked||Pe(t)==null)&&n(e.checked),Fe(()=>{var s=t();e.checked=!!s})}function oe(e){var t=e.type;return t==="number"||t==="range"}function ce(e){return e===""?null:+e}const Ft="unsolvable";class Tt extends Error{}function _e(e,t){if(!e)throw new Tt("[ASSERT] "+t)}function Me(e,t,n){return n.indexOf(e)===t}const Lt=":",P="n:",ue="e:",ns="n%:",rs="source",as="target",is="n%c:",ls="n%i:",os="n%t:",cs="n%f:",us="T:",ds="F:",fs="filler1:",vs="filler2:",hs={CORE:{T:P+"T",F:P+"F",B:P+"B"},TRUE_VAR_NODE_PREFIX:"nvt:",FALSE_VAR_NODE_PREFIX:"nvf:",CLAUSE_NODE_PREFIX:"nc:",COLOR_TRUE:1,COLOR_FALSE:0,COLOR_BUFFER:2},Se={CLAUSE_PREFIX:"c:",VAR_PREFIX:"v:"},_s={INCOMING_NODE_PREFIX:"nin:",GAP_NODE_PREFIX:"ngap:",OUTGOING_NODE_PREFIX:"nout:"},gs=e=>e.startsWith(P)?e.slice(P.length):e;class p{static SerializableClass(t){return function(n){const s=t??n.name;n.prototype.__type=s,p.registerClass(s,n)}}static serialize(t){if(t==null)return t;if(Array.isArray(t))return t.map(p.serialize);if(t instanceof Set)return{__type:"Set",values:Array.from(t).map(p.serialize)};if(t instanceof Map)return{__type:"Map",entries:Array.from(t.entries()).map(([n,s])=>[p.serialize(n),p.serialize(s)])};if(typeof t=="object"){if(Array.isArray(t))return t.map(p.serialize);const n=t.constructor,r={__type:t.__type??n.name};for(const[a,i]of Object.entries(t))r[a]=p.serialize(i);return r}return t}static revive(t){if(t==null)return t;if(Array.isArray(t))return t.map(p.revive);if(t.__type==="Set")return new Set(t.values.map(p.revive));if(t.__type==="Map")return new Map(t.entries.map(([n,s])=>[p.revive(n),p.revive(s)]));if(t.__type){const n=p.getClass(t.__type);if(!n)throw new Error(`Serializer - Unknown class: ${t.__type}`);const s=Object.create(n.prototype);for(const[r,a]of Object.entries(t))r!=="__type"&&(s[r]=p.revive(a));return s}return t}static registerClass(t,n){p.classRegistry.set(t,n)}static getClass(t){return p.classRegistry.get(t)}static classRegistry=new Map}p.registerClass(Object.name,Object);class Ue{}var kt=Object.getOwnPropertyDescriptor,ge=(e,t,n,s)=>{for(var r=s>1?void 0:s?kt(t,n):t,a=e.length-1,i;a>=0;a--)(i=e[a])&&(r=i(r)||r);return r};let q=class{id;varName;negated;constructor(e,t,n=!1){this.id=e,this.varName=t,this.negated=n}toJson(){return{__type:q.name,id:this.id,varName:this.varName,negated:this.negated}}asString(){return`${this.negated?"!":""}${this.varName}`}asHtmlString(){return(this.negated?"&not;":"")+this.varName}};q=ge([p.SerializableClass("Literal")],q);let B=class{id;literals;constructor(e,t){_e(t.length==3),this.id=e,this.literals=[t[0],t[1],t[2]]}asString(){return this.literals.map(e=>e.asString()).join(" ")}asHtmlString(){return"("+this.literals.map(t=>t.asHtmlString()).join("&or;")+")"}toJSON(){return{__type:B.name,id:this.id,literals:this.literals}}};B=ge([p.SerializableClass("Clause")],B);let $=class extends Ue{_variables=new Set;_clauses=new Set;addVariable(e){this._variables.add(e)}addClause(e){this._clauses.add(e),e.literals.forEach(t=>this.addVariable(t.varName))}asString(){return Array.from(this._clauses.values()).map(e=>e.asString()).join(`
`)}asHtmlString(){return this.clauses.map(e=>e.asHtmlString()).join("&and;")}get variables(){return Array.from(this._variables.values())}get clauses(){return Array.from(this._clauses.values())}isEmpty(){return this.clauses.length==0||this.variables.length==0}static fromString(e){const t=e.split(`
`).map(s=>s.trim()).filter(s=>s.length).filter(Me);let n=new $;for(let s=0;s<t.length;s++){const r=t[s],a=r.split(" ").map(d=>d.trim()).filter(d=>d.length);if(a.length!=3)return`Clause number ${s+1} (${r}) doesn't have exactly 3 literals.Instead it has ${a.length} literals.`;const i=Se.CLAUSE_PREFIX+s;let l=[];for(let d=0;d<a.length;d++){let u=a[d];const b=u.startsWith("!");if(b&&(u=u.replace("!","")),u.includes("!")||u.includes("||")||u.includes("&&"))return`Literal ${b?"!":""}${u} is invalid.`;const v=Se.VAR_PREFIX+d,w=new q(`${v}-${i}`,u,b);l.push(w)}_e(l.length==3);const g=new B(i,l);n.addClause(g)}return n}copy(){const e=new $;return this._variables.forEach(t=>e.addVariable(t)),this._clauses.forEach(t=>{const n=t.literals.map(r=>new q(r.id,r.varName,r.negated)),s=new B(t.id,n);e.addClause(s)}),e}toSerializedString(){throw"Not implemented"}static fromSerializedString(e){throw"Not implemented"}};$=ge([p.SerializableClass("CNF3")],$);var Mt=Object.getOwnPropertyDescriptor,Ut=(e,t,n,s)=>{for(var r=s>1?void 0:s?Mt(t,n):t,a=e.length-1,i;a>=0;a--)(i=e[a])&&(r=i(r)||r);return r};let V=class extends Ue{_nodes;_edges;constructor(){super(),this._nodes=new Set,this._edges=new Set}addNode(e){e.classes==null&&(e.classes=""),!this.nodes.find(t=>t.id==e.id)&&this._nodes.add(e)}addEdge(e){e.classes==null&&(e.classes=""),e.controlPointDistances==null&&(e.controlPointDistances=[0,0]),_e(e.controlPointDistances.length==2,"There must be 2 control points."),!this.edges.find(t=>t.id==e.id)&&this._edges.add(e)}get nodes(){return Array.from(this._nodes.values())}get edges(){return Array.from(this._edges.values())}removeNode(e){if(!this._nodes.has(e))return;this._nodes.delete(e),Array.from(this.edges).filter(n=>n.to===e.id||n.from===e.id).forEach(n=>this._edges.delete(n))}removeEdge(e){this._edges.delete(e)}removeEdgeById(e){const t=this.edges.find(n=>n.id==e);t?(console.log("deleting edge with id",e),this._edges.delete(t)):console.log("edge with id",e,"not found")}isEmpty(){return this.nodes.length==0}copy(){const e=new V;for(const t of this._nodes)e.addNode({id:t.id,label:t.label,color:t.color,position:t.position?{...t.position}:void 0,classes:t.classes});for(const t of this._edges)e.addEdge({id:t.id,from:t.from,to:t.to,weight:t.weight,classes:t.classes,controlPointDistances:t.controlPointDistances});return e}asString(){const e=this.nodes.map(n=>n.id.slice(P.length)).join(`
`),t=this.edges.map(n=>n.from.slice(P.length)+" "+n.to.slice(P.length)+(n.weight!=null?" "+n.weight:"")).join(`
`);return e+`
`+t+`
`}static fromString(e){if(e.length==0)return"Cannot construct a graph from empty string";const t=e.split(`
`).map(s=>s.trim()).filter(s=>s.length).filter(Me);let n=new V;console.debug("LINES",t);for(let s=0;s<t.length;s++){const a=t[s].split(" ").map(i=>i.trim()).filter(i=>i.length);if(a.length==1){const i=a;n.addNode({id:P+i})}else if(a.length<=3){const i=a[0],l=a[1];let g;if(a.length==3)try{g=Number.parseFloat(a[2])}catch{return`On the line ${s}, couldn't parse the weight: '${a[2]}Please enter a number (floating allowed)`}const d=P+i,u=P+l;n.addNode({id:d}),n.addNode({id:u}),n.addEdge({id:ue+`${d}-${u}`,from:d,to:u,weight:g})}}return n}toSerializedString(){const e={nodes:this.nodes.map(t=>({id:t.id,label:t.label??null,color:t.color??null,position:t.position??null,classes:t.classes??""})),edges:this.edges.map(t=>({id:t.id,from:t.from,to:t.to,weight:t.weight??null,classes:t.classes??"",controlPointDistances:t.controlPointDistances??[0,0]}))};return JSON.stringify(e,null)}static fromSerializedString(e){const t=JSON.parse(e),n=new V;if(Array.isArray(t.nodes))for(const s of t.nodes)n.addNode({id:s.id,label:s.label??void 0,color:s.color??void 0,position:s.position??void 0,classes:s.classes??""});if(Array.isArray(t.edges))for(const s of t.edges)n.addEdge({id:s.id,from:s.from,to:s.to,weight:s.weight??void 0,classes:s.classes??"",controlPointDistances:s.controlPointDistances??[0,0]});return n}labelSolved({path:e=[],directed:t=!1,edgeIdUsesNodeIds:n=!0}={}){console.debug("edgeIdUsesNodeIds",n);const s=n?(r=>r):(r=>r.slice(r.search(Lt)+1));this.edges.forEach(r=>r.classes+=" solved");for(let r=0;r<e.length-1;r++){const a=s(e[r].id),i=s(e[r+1].id),l=ue+`${a}-${i}`,g=ue+`${i}-${a}`,d=this.edges.find(u=>u.id==l||!t&&u.id==g);console.debug("edgeId",l,"edgeIdMirror",g,"edge found",d!=null),d&&(d.classes+=" used")}}unlabelSolved(){this._edges.forEach(e=>{e.classes&&(e.classes=e.classes.replaceAll("used",""),e.classes=e.classes.replaceAll("solved",""))})}};V=Ut([p.SerializableClass()],V);class ve{static cnf3TextInput={NO_SOLUTION:`x y z
!x y z
x !y z
!x !y z
x y !z
!x y !z
x !y !z
!x !y !z
`,BASIC:`x y z
a b c
`};static graphTextInput={CYCLE:`0 1
1 2
2 3
3 4
4 0
`,PATH:`0 1
1 2
2 3
3 4
`,COMPLETE:`0 1
1 2
2 3
3 4
0 2
0 3
0 4
1 3
1 4
2 4
`};static getTextInputs(t){if(t===$)return ve.cnf3TextInput;if(t===V)return ve.graphTextInput;throw new Error(`No demos provided for class ${t.name}.`)}}function Xt(e,t,n){t()&&n.stepIndex>0&&t()()}function zt(e,t,n,s){t()&&n.stepIndex<s-1&&t()()}var Ht=j("<h3> </h3> <p><!></p> <!>",1),Vt=j("<h3> </h3> <p><!></p>",1),Gt=j('<section><div class="header svelte-bomf3d"><h2>Reduction Stepper</h2> <div class="controls"><div><input type="checkbox" name="showAllCheckbox"/> <label for="showAllCheckbox">Show all</label></div> <div><button>Previous</button> <button>Next</button> <span> </span></div></div></div> <!></section>');function ps(e,t){ft(t,!0);let n=ae(t,"indent",3,0),s=ae(t,"onNextClick",3,void 0),r=ae(t,"onPrevClick",3,void 0);const a=t.steps.length;let i=ht(!1);var l=Gt(),g=O(l),d=k(O(g),2),u=O(d),b=O(u);yt(b),vt(2),x(u);var v=k(u,2),w=O(v);w.__click=[Xt,r,t];var o=k(w,2);o.__click=[zt,s,t,a];var f=k(o,2),_=O(f);x(f),x(v),x(d),x(g);var m=k(g,2);{var S=y=>{var I=Ee(),c=Y(I);Nt(c,17,()=>t.steps,St,(h,E,F)=>{var T=Ht(),C=Y(T),N=O(C);x(C);var R=k(C,2),U=O(R);be(U,()=>M(E).description),x(R);var X=k(R,2);ie(X,J=>{}),ne(()=>re(N,`Step #${F+1}: ${M(E).title??""}`)),H(h,T)}),H(y,I)},A=y=>{var I=Ee(),c=Y(I);{var h=E=>{const F=pt(()=>t.steps[t.stepIndex]);var T=Vt(),C=Y(T),N=O(C);x(C);var R=k(C,2),U=O(R);be(U,()=>M(F).description),x(R),ne(()=>re(N,`Step #${t.stepIndex+1}: ${M(F).title??""}`)),H(E,T)};ie(c,E=>{t.stepIndex<t.steps.length&&E(h)})}H(y,I)};ie(m,y=>{M(i)?y(S):y(A,!1)})}x(l),ne(()=>{Rt(l,`padding-left: ${n()*100}px; border: solid black 1px`),re(_,`${t.stepIndex+1}/${a??""}`)}),Pt(b,()=>M(i),y=>_t(i,y)),H(e,l),gt()}It(["click"]);var Wt=j('<main><div class="loading svelte-nrcxd8"><span class="spinner svelte-nrcxd8"></span> <span><!></span></div></main>');function ms(e,t){var n=Wt(),s=O(n),r=k(O(s),2),a=O(r);Et(a,()=>t.children),x(r),x(s),x(n),H(e,n)}function Is(e,t,n={serialize:s=>p.serialize(s),revive:s=>p.revive(s)}){let s=K(t);wt(()=>{const a=localStorage.getItem(e);if(a){const i=n.revive(JSON.parse(a));s.set(i)}});const r=()=>{if(we(s)){const a=JSON.stringify(n.serialize(we(s)));localStorage.setItem(e,a)}else localStorage.removeItem(e)};return{value:s,save:()=>r()}}function Es(e){let t=e.storage.value,n=K(!1),s=K(!1),r=K(""),a=null,i=null,l=null,g=!1;t.subscribe(v=>{g=v.hasOutCertificate(),i=v.inInstance,l=v.outInstance});function d(v){console.debug("editorChanged"),a&&(a.terminate(),a=null,s.set(!1),r.set("Solving cancelled.")),t.update(w=>(w.reset(),w.setInInstance(v),w)),e.storage.save()}function u(){if(!i||i.isEmpty())return;const v=e.reducerFactory(i),{outInstance:w,steps:o}=v.reduce();t.update(f=>(f.setSteps(o),f.setOutInstance(w),f)),e.storage.save()}async function b(){if(console.debug("useReductionController::solve()"),!e.workerUrl)throw console.debug("Worker URL not provided"),new Error("Worker URL not provided");if(!l)throw console.debug("Output instance is not set"),new Error("Output instance is not set");if(g)throw console.debug("Reduction storage already has certificate of the output problem"),new Error("Reduction storage already has certificate of the output problem");s.set(!0),r.set("Solving..."),a&&a.terminate(),console.debug("creating new worker...");const v=new Worker(e.workerUrl,{type:"module"});a=v,console.debug("new worker created"),console.debug("creating worker message...");const w=e.createWorkerMessage?.(l)??l.toSerializedString();console.debug("posting  worker message..."),v.postMessage(w);try{console.debug("awaiting result...");const o=await new Promise((f,_)=>{v.onmessage=m=>f(m.data),v.onerror=m=>_(m)});console.debug("updating reduction store..."),t.update(f=>{if(f.outCert=o,o!=Ft){console.debug("creating decoder factory...");const _=e.decoderFactory();console.debug("decoding..."),f.inCert=_.decode(f.outInstance,o)}return f}),console.debug("calling onSolveFinished callback..."),e.onSolveFinished?.(l,o),console.debug("saving to local storage..."),e.storage.save(),console.debug("unset the solve message..."),r.set(""),console.debug("success")}catch(o){console.error("Error occured while solving:",o),r.set(`Error occured while solving: ${o}`)}finally{s.set(!1),v.terminate(),a=null}}return bt(()=>{a&&(a.terminate(),a=null)}),mt(()=>{t.update(v=>(v.resetStepIndex(),v))}),{redStore:t,showStepper:n,isSolving:s,solveMessage:r,editorChanged:d,reduce:u,solve:b}}class ws{constructor(t){this.inInstance=t}reduce(){if(this.inInstance.isEmpty())throw"Call to reduce failed. Input instance is empty.";return this.doReduce()}}var qt=Object.getOwnPropertyDescriptor,Bt=(e,t,n,s)=>{for(var r=s>1?void 0:s?qt(t,n):t,a=e.length-1,i;a>=0;a--)(i=e[a])&&(r=i(r)||r);return r};let Ce=class{inInstance=null;outInstance=null;steps=[];stepIndex=0;inCert=null;outCert=null;reset(){this.inInstance=null,this.outInstance=null,this.inCert=null,this.outCert=null,this.steps=[],this.stepIndex=0}resetStepIndex(){this.stepIndex=0}setInInstance(e){this.reset(),this.inInstance=e}setOutInstance(e){this.outInstance=e}setSteps(e){this.steps=e,this.stepIndex=0}nextStep(){const e=this.steps.length;this.stepIndex=Math.min(this.stepIndex+1,e)}prevStep(){this.stepIndex=Math.max(this.stepIndex-1,0)}hasInstances(){return this.inInstance!=null&&this.outInstance!=null}hasInInstance(){return this.inInstance!=null}hasOutInstance(){return this.outInstance!=null}hasInCertificate(){return this.inCert!=null}hasOutCertificate(){return this.outCert!=null}};Ce=Bt([p.SerializableClass("ReductionStore")],Ce);export{$ as C,ve as D,ue as E,V as G,_s as H,P as N,Ue as P,ws as R,p as S,as as T,Ft as U,us as V,Ce as a,Pt as b,Es as c,ms as d,Nt as e,ps as f,ss as g,ts as h,St as i,gs as j,os as k,cs as l,is as m,ns as n,rs as o,ls as p,hs as q,_e as r,Se as s,es as t,Is as u,jt as v,ds as w,fs as x,vs as y};
