import{T as Be,v as D,w as qe,m as M,ac as Ge,V as $e,W as We,X as pe,E as te,Y as se,z as B,C as Je,aS as Ye,_ as fe,a2 as Ke,a0 as z,aw as me,Z as Oe,a6 as Ze,au as Ee,aP as Ae,aK as Ne,b0 as Q,a3 as xe,a4 as Qe,b1 as j,b2 as je,b3 as ne,aE as De,A as et,b4 as tt,aO as st,b5 as nt,x as rt,G as at,b6 as Fe,q as it,b7 as lt,b8 as _e,e as ot,a7 as ct,b9 as dt,ba as ut,as as ft,u as Le,g as Pe,bb as vt,p as ht,f as ee,d as O,s as T,K as _t,r as A,L as gt,t as re,M as pt,b as V,c as mt,ao as Ie,a as Y,ap as Et,j as It}from"./BHy43uIv.js";import"./DsnmJJEf.js";import{d as wt,s as ae,b as bt,o as yt,w as K,g as we,c as St}from"./Bo-e_C1i.js";import{p as ie,i as le}from"./lPMcd3W4.js";import{h as be}from"./_9mKL30m.js";import{r as Ct}from"./hAUU4et8.js";function Rt(e,t){return t}function Ot(e,t,n){for(var s=e.items,r=[],a=t.length,i=0;i<a;i++)tt(t[i].e,r,!0);var o=a>0&&r.length===0&&n!==null;if(o){var g=n.parentNode;st(g),g.append(n),s.clear(),P(e,t[0].prev,t[a-1].next)}nt(r,()=>{for(var f=0;f<a;f++){var d=t[f];o||(s.delete(d.k),P(e,d.prev,d.next)),De(d.e,!o)}})}function At(e,t,n,s,r,a=null){var i=e,o={flags:t,items:new Map,first:null},g=(t&Fe)!==0;if(g){var f=e;i=D?te(at(f)):f.appendChild(Oe())}D&&qe();var d=null,y=!1,v=new Map,b=Ge(()=>{var m=n();return Ne(m)?m:m==null?[]:Ae(m)}),l,u;function _(){Nt(u,l,o,v,i,r,t,s,n),a!==null&&(l.length===0?d?xe(d):d=fe(()=>a(i)):d!==null&&Qe(d,()=>{d=null}))}Be(()=>{u??=rt,l=M(b);var m=l.length;if(y&&m===0)return;y=m===0;let w=!1;if(D){var N=$e(i)===We;N!==(m===0)&&(i=pe(),te(i),se(!1),w=!0)}if(D){for(var S=null,E,c=0;c<m;c++){if(B.nodeType===Je&&B.data===Ye){i=B,w=!0,se(!1);break}var h=l[c],I=s(h,c);E=ve(B,o,S,null,h,I,c,r,t,n),o.items.set(I,E),S=E}m>0&&te(pe())}if(D)m===0&&a&&(d=fe(()=>a(i)));else if(Ke()){var F=new Set,L=z;for(c=0;c<m;c+=1){h=l[c],I=s(h,c);var C=o.items.get(I)??v.get(I);C?(t&(j|Q))!==0&&Te(C,h,c,t):(E=ve(null,o,null,null,h,I,c,r,t,n,!0),v.set(I,E)),F.add(I)}for(const[R,x]of o.items)F.has(R)||L.skipped_effects.add(x.e);L.add_callback(_)}else _();w&&se(!0),M(b)}),D&&(i=B)}function Nt(e,t,n,s,r,a,i,o,g){var f=(i&lt)!==0,d=(i&(j|Q))!==0,y=t.length,v=n.items,b=n.first,l=b,u,_=null,m,w=[],N=[],S,E,c,h;if(f)for(h=0;h<y;h+=1)S=t[h],E=o(S,h),c=v.get(E),c!==void 0&&(c.a?.measure(),(m??=new Set).add(c));for(h=0;h<y;h+=1){if(S=t[h],E=o(S,h),c=v.get(E),c===void 0){var I=s.get(E);if(I!==void 0){s.delete(E),v.set(E,I);var F=_?_.next:l;P(n,_,I),P(n,I,F),oe(I,F,r),_=I}else{var L=l?l.e.nodes_start:r;_=ve(L,n,_,_===null?n.first:_.next,S,E,h,a,i,g)}v.set(E,_),w=[],N=[],l=_.next;continue}if(d&&Te(c,S,h,i),(c.e.f&ne)!==0&&(xe(c.e),f&&(c.a?.unfix(),(m??=new Set).delete(c))),c!==l){if(u!==void 0&&u.has(c)){if(w.length<N.length){var C=N[0],R;_=C.prev;var x=w[0],U=w[w.length-1];for(R=0;R<w.length;R+=1)oe(w[R],C,r);for(R=0;R<N.length;R+=1)u.delete(N[R]);P(n,x.prev,U.next),P(n,_,x),P(n,U,C),l=C,_=U,h-=1,w=[],N=[]}else u.delete(c),oe(c,l,r),P(n,c.prev,c.next),P(n,c,_===null?n.first:_.next),P(n,_,c),_=c;continue}for(w=[],N=[];l!==null&&l.k!==E;)(l.e.f&ne)===0&&(u??=new Set).add(l),N.push(l),l=l.next;if(l===null)continue;c=l}w.push(c),_=c,l=c.next}if(l!==null||u!==void 0){for(var X=u===void 0?[]:Ae(u);l!==null;)(l.e.f&ne)===0&&X.push(l),l=l.next;var J=X.length;if(J>0){var Ve=(i&Fe)!==0&&y===0?r:null;if(f){for(h=0;h<J;h+=1)X[h].a?.measure();for(h=0;h<J;h+=1)X[h].a?.fix()}Ot(n,X,Ve)}}f&&it(()=>{if(m!==void 0)for(c of m)c.a?.apply()}),e.first=n.first&&n.first.e,e.last=_&&_.e;for(var He of s.values())De(He.e);s.clear()}function Te(e,t,n,s){(s&j)!==0&&me(e.v,t),(s&Q)!==0?me(e.i,n):e.i=n}function ve(e,t,n,s,r,a,i,o,g,f,d){var y=(g&j)!==0,v=(g&je)===0,b=y?v?Ze(r,!1,!1):Ee(r):r,l=(g&Q)===0?i:Ee(i),u={i:l,v:b,k:a,a:null,e:null,prev:n,next:s};try{if(e===null){var _=document.createDocumentFragment();_.append(e=Oe())}return u.e=fe(()=>o(e,b,l,f),D),u.e.prev=n&&n.e,u.e.next=s&&s.e,n===null?d||(t.first=u):(n.next=u,n.e.next=u.e),s!==null&&(s.prev=u,s.e.prev=u.e),u}finally{}}function oe(e,t,n){for(var s=e.next?e.next.e.nodes_start:n,r=t?t.e.nodes_start:n,a=e.e.nodes_start;a!==null&&a!==s;){var i=et(a);r.before(a),a=i}}function P(e,t,n){t===null?e.first=n:(t.next=n,t.e.next=n&&n.e),n!==null&&(n.prev=t,n.e.prev=t&&t.e)}function ke(e){var t,n,s="";if(typeof e=="string"||typeof e=="number")s+=e;else if(typeof e=="object")if(Array.isArray(e)){var r=e.length;for(t=0;t<r;t++)e[t]&&(n=ke(e[t]))&&(s&&(s+=" "),s+=n)}else for(n in e)e[n]&&(s&&(s+=" "),s+=n);return s}function xt(){for(var e,t,n=0,s="",r=arguments.length;n<r;n++)(e=arguments[n])&&(t=ke(e))&&(s&&(s+=" "),s+=t);return s}function es(e){return typeof e=="object"?xt(e):e??""}const ye=[...` 	
\r\fÂ \v\uFEFF`];function ts(e,t,n){var s=e==null?"":""+e;if(t&&(s=s?s+" "+t:t),n){for(var r in n)if(n[r])s=s?s+" "+r:r;else if(s.length)for(var a=r.length,i=0;(i=s.indexOf(r,i))>=0;){var o=i+a;(i===0||ye.includes(s[i-1]))&&(o===s.length||ye.includes(s[o]))?s=(i===0?"":s.substring(0,i))+s.substring(o+1):i=o}}return s===""?null:s}function Dt(e,t){return e==null?null:String(e)}function Ft(e,t,n,s){var r=e.__style;if(D||r!==t){var a=Dt(t);(!D||a!==e.getAttribute("style"))&&(a==null?e.removeAttribute("style"):e.style.cssText=a),e.__style=t}return s}function Me(e,t,n=!1){if(e.multiple){if(t==null)return;if(!Ne(t))return dt();for(var s of e.options)s.selected=t.includes(q(s));return}for(s of e.options){var r=q(s);if(ut(r,t)){s.selected=!0;return}}(!n||t!==void 0)&&(e.selectedIndex=-1)}function Lt(e){var t=new MutationObserver(()=>{Me(e,e.__value)});t.observe(e,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),ct(()=>{t.disconnect()})}function ss(e,t,n=t){var s=!0;_e(e,"change",r=>{var a=r?"[selected]":":checked",i;if(e.multiple)i=[].map.call(e.querySelectorAll(a),q);else{var o=e.querySelector(a)??e.querySelector("option:not([disabled])");i=o&&q(o)}n(i)}),ot(()=>{var r=t();if(Me(e,r,s),s&&r===void 0){var a=e.querySelector(":checked");a!==null&&(r=q(a),n(r))}e.__value=r,s=!1}),Lt(e)}function q(e){return"__value"in e?e.__value:e.value}function ns(e,t,n=t){var s=new WeakSet;_e(e,"input",async r=>{var a=r?e.defaultValue:e.value;if(a=ce(e)?de(a):a,n(a),z!==null&&s.add(z),await ft(),a!==(a=t())){var i=e.selectionStart,o=e.selectionEnd;e.value=a??"",o!==null&&(e.selectionStart=i,e.selectionEnd=Math.min(o,e.value.length))}}),(D&&e.defaultValue!==e.value||Le(t)==null&&e.value)&&(n(ce(e)?de(e.value):e.value),z!==null&&s.add(z)),Pe(()=>{var r=t();if(e===document.activeElement){var a=vt??z;if(s.has(a))return}ce(e)&&r===de(e.value)||e.type==="date"&&!r&&!e.value||r!==e.value&&(e.value=r??"")})}function Pt(e,t,n=t){_e(e,"change",s=>{var r=s?e.defaultChecked:e.checked;n(r)}),(D&&e.defaultChecked!==e.checked||Le(t)==null)&&n(e.checked),Pe(()=>{var s=t();e.checked=!!s})}function ce(e){var t=e.type;return t==="number"||t==="range"}function de(e){return e===""?null:+e}const Se="unsolvable";class Tt extends Error{}function Ue(e,t){if(!e)throw new Tt("[ASSERT] "+t)}function Xe(e,t,n){return n.indexOf(e)===t}const kt=":",k="n:",ue="e:",rs="n%:",as="source",is="target",ls="n%c:",os="n%i:",cs="n%t:",ds="n%f:",us="T:",fs="F:",vs="filler1:",hs="filler2:",_s={CORE:{T:k+"T",F:k+"F",B:k+"B"},TRUE_VAR_NODE_PREFIX:"nvt:",FALSE_VAR_NODE_PREFIX:"nvf:",CLAUSE_NODE_PREFIX:"nc:",COLOR_TRUE:1,COLOR_FALSE:0,COLOR_BUFFER:2},Ce={CLAUSE_PREFIX:"c:",VAR_PREFIX:"v:"},gs={INCOMING_NODE_PREFIX:"nin:",GAP_NODE_PREFIX:"ngap:",OUTGOING_NODE_PREFIX:"nout:"};class p{static SerializableClass(t){return function(n){const s=t??n.name;n.prototype.__type=s,p.registerClass(s,n)}}static serialize(t){if(t==null)return t;if(Array.isArray(t))return t.map(p.serialize);if(t instanceof Set)return{__type:"Set",values:Array.from(t).map(p.serialize)};if(t instanceof Map)return{__type:"Map",entries:Array.from(t.entries()).map(([n,s])=>[p.serialize(n),p.serialize(s)])};if(typeof t=="object"){if(Array.isArray(t))return t.map(p.serialize);const n=t.constructor,r={__type:t.__type??n.name};for(const[a,i]of Object.entries(t))r[a]=p.serialize(i);return r}return t}static revive(t){if(t==null)return t;if(Array.isArray(t))return t.map(p.revive);if(t.__type==="Set")return new Set(t.values.map(p.revive));if(t.__type==="Map")return new Map(t.entries.map(([n,s])=>[p.revive(n),p.revive(s)]));if(t.__type){const n=p.getClass(t.__type);if(!n)throw new Error(`Serializer - Unknown class: ${t.__type}`);const s=Object.create(n.prototype);for(const[r,a]of Object.entries(t))r!=="__type"&&(s[r]=p.revive(a));return s}return t}static registerClass(t,n){p.classRegistry.set(t,n)}static getClass(t){return p.classRegistry.get(t)}static classRegistry=new Map}p.registerClass(Object.name,Object);class ze{}var Mt=Object.getOwnPropertyDescriptor,ge=(e,t,n,s)=>{for(var r=s>1?void 0:s?Mt(t,n):t,a=e.length-1,i;a>=0;a--)(i=e[a])&&(r=i(r)||r);return r};let G=class{id;varName;negated;constructor(e,t,n=!1){this.id=e,this.varName=t,this.negated=n}toJson(){return{__type:G.name,id:this.id,varName:this.varName,negated:this.negated}}asString(){return`${this.negated?"!":""}${this.varName}`}asHtmlString(){return(this.negated?"&not;":"")+this.varName}};G=ge([p.SerializableClass("Literal")],G);let $=class{id;literals;constructor(e,t){Ue(t.length==3),this.id=e,this.literals=[t[0],t[1],t[2]]}asString(){return this.literals.map(e=>e.asString()).join(" ")}asHtmlString(){return"("+this.literals.map(t=>t.asHtmlString()).join("&or;")+")"}toJSON(){return{__type:$.name,id:this.id,literals:this.literals}}};$=ge([p.SerializableClass("Clause")],$);let W=class extends ze{_variables=new Set;_clauses=new Set;addVariable(e){this._variables.add(e)}addClause(e){this._clauses.add(e),e.literals.forEach(t=>this.addVariable(t.varName))}asString(){return Array.from(this._clauses.values()).map(e=>e.asString()).join(`
`)}asHtmlString(){return this.clauses.map(e=>e.asHtmlString()).join("&and;")}get variables(){return Array.from(this._variables.values())}get clauses(){return Array.from(this._clauses.values())}isEmpty(){return this.clauses.length==0||this.variables.length==0}static fromString(e){const t=e.split(`
`).map(s=>s.trim()).filter(s=>s.length).filter(Xe);let n=new W;for(let s=0;s<t.length;s++){const r=t[s],a=r.split(" ").map(f=>f.trim()).filter(f=>f.length);if(a.length!=3)return`Clause number ${s+1} (${r}) doesn't have exactly 3 literals.Instead it has ${a.length} literals.`;const i=Ce.CLAUSE_PREFIX+s;let o=[];for(let f=0;f<a.length;f++){let d=a[f];const y=d.startsWith("!");if(y&&(d=d.replace("!","")),d.includes("!")||d.includes("||")||d.includes("&&"))return`Literal ${y?"!":""}${d} is invalid.`;const v=Ce.VAR_PREFIX+f,b=new G(`${v}-${i}`,d,y);o.push(b)}Ue(o.length==3);const g=new $(i,o);n.addClause(g)}return n}copy(){const e=new W;return this._variables.forEach(t=>e.addVariable(t)),this._clauses.forEach(t=>{const n=t.literals.map(r=>new G(r.id,r.varName,r.negated)),s=new $(t.id,n);e.addClause(s)}),e}toSerializedString(){throw"Not implemented"}static fromSerializedString(e){throw"Not implemented"}};W=ge([p.SerializableClass("CNF3")],W);var Ut=Object.getOwnPropertyDescriptor,Xt=(e,t,n,s)=>{for(var r=s>1?void 0:s?Ut(t,n):t,a=e.length-1,i;a>=0;a--)(i=e[a])&&(r=i(r)||r);return r};let H=class extends ze{_nodes;_edges;constructor(){super(),this._nodes=new Set,this._edges=new Set}addNode(e){e.classes==null&&(e.classes=""),!this.nodes.find(t=>t.id==e.id)&&this._nodes.add(e)}addEdge(e){e.classes==null&&(e.classes=""),!this.edges.find(t=>t.id==e.id)&&this._edges.add(e)}get nodes(){return Array.from(this._nodes.values())}get edges(){return Array.from(this._edges.values())}removeNode(e){if(!this._nodes.has(e))return;this._nodes.delete(e),Array.from(this.edges).filter(n=>n.to===e.id||n.from===e.id).forEach(n=>this._edges.delete(n))}removeEdge(e){this._edges.delete(e)}removeEdgeById(e){const t=this.edges.find(n=>n.id==e);t?(console.log("deleting edge with id",e),this._edges.delete(t)):console.log("edge with id",e,"not found")}isEmpty(){return this.nodes.length==0}copy(){const e=new H;for(const t of this._nodes)e.addNode({id:t.id,label:t.label,color:t.color,position:t.position?{...t.position}:void 0,classes:t.classes});for(const t of this._edges)e.addEdge({id:t.id,from:t.from,to:t.to,weight:t.weight,classes:t.classes,controlPointDistances:t.controlPointDistances});return e}asString(){const e=this.nodes.map(n=>n.id.slice(k.length)).join(`
`),t=this.edges.map(n=>n.from.slice(k.length)+" "+n.to.slice(k.length)+(n.weight!=null?" "+n.weight:"")).join(`
`);return e+`
`+t+`
`}static fromString(e){if(e.length==0)return"Cannot construct a graph from empty string";const t=e.split(`
`).map(s=>s.trim()).filter(s=>s.length).filter(Xe);let n=new H;console.debug("LINES",t);for(let s=0;s<t.length;s++){const a=t[s].split(" ").map(i=>i.trim()).filter(i=>i.length);if(a.length==1){const i=a;n.addNode({id:k+i})}else if(a.length<=3){const i=a[0],o=a[1];let g;if(a.length==3)try{g=Number.parseFloat(a[2])}catch{return`On the line ${s}, couldn't parse the weight: '${a[2]}Please enter a number (floating allowed)`}const f=k+i,d=k+o;n.addNode({id:f}),n.addNode({id:d}),n.addEdge({id:ue+`${f}-${d}`,from:f,to:d,weight:g})}}return n}toSerializedString(){const e={nodes:this.nodes.map(t=>({id:t.id,label:t.label??null,color:t.color??null,position:t.position??null,classes:t.classes??""})),edges:this.edges.map(t=>({id:t.id,from:t.from,to:t.to,weight:t.weight??null,classes:t.classes??"",controlPointDistances:t.controlPointDistances??[0,0]}))};return JSON.stringify(e,null)}static fromSerializedString(e){const t=JSON.parse(e),n=new H;if(Array.isArray(t.nodes))for(const s of t.nodes)n.addNode({id:s.id,label:s.label??void 0,color:s.color??void 0,position:s.position??void 0,classes:s.classes??""});if(Array.isArray(t.edges))for(const s of t.edges)n.addEdge({id:s.id,from:s.from,to:s.to,weight:s.weight??void 0,classes:s.classes??"",controlPointDistances:s.controlPointDistances??[0,0]});return n}labelSolved({path:e=[],directed:t=!1,edgeIdUsesNodeIds:n=!0}={}){console.debug("edgeIdUsesNodeIds",n);const s=n?(r=>r):(r=>r.slice(r.search(kt)+1));this.edges.forEach(r=>r.classes+=" solved");for(let r=0;r<e.length-1;r++){const a=s(e[r].id),i=s(e[r+1].id),o=ue+`${a}-${i}`,g=ue+`${i}-${a}`,f=this.edges.find(d=>d.id==o||!t&&d.id==g);console.debug("edgeId",o,"edgeIdMirror",g,"edge found",f!=null),f&&(f.classes+=" used")}}unlabelSolved(){this._edges.forEach(e=>{e.classes&&(e.classes=e.classes.replaceAll("used",""),e.classes=e.classes.replaceAll("solved",""))})}};H=Xt([p.SerializableClass()],H);class he{static cnf3TextInput={NO_SOLUTION:`x y z
!x y z
x !y z
!x !y z
x y !z
!x y !z
x !y !z
!x !y !z
`,BASIC:`x y z
a b c
`};static graphTextInput={CYCLE:`0 1
1 2
2 3
3 4
4 0
`,PATH:`0 1
1 2
2 3
3 4
`,COMPLETE:`0 1
1 2
2 3
3 4
0 2
0 3
0 4
1 3
1 4
2 4
`};static getTextInputs(t){if(t===W)return he.cnf3TextInput;if(t===H)return he.graphTextInput;throw new Error(`No demos provided for class ${t.name}.`)}}function zt(e,t,n){t()&&n.stepIndex>0&&t()()}function Vt(e,t,n,s){t()&&n.stepIndex<s-1&&t()()}var Ht=ee("<h3> </h3> <p><!></p> <!>",1),Bt=ee("<h3> </h3> <p><!></p>",1),qt=ee('<section><div class="header svelte-bomf3d"><h2>Reduction Stepper</h2> <div class="controls"><div><input type="checkbox" name="showAllCheckbox"/> <label for="showAllCheckbox">Show all</label></div> <div><button>Previous</button> <button>Next</button> <span> </span></div></div></div> <!></section>');function ps(e,t){ht(t,!0);let n=ie(t,"indent",3,0),s=ie(t,"onNextClick",3,void 0),r=ie(t,"onPrevClick",3,void 0);const a=t.steps.length;let i=gt(!1);var o=qt(),g=O(o),f=T(O(g),2),d=O(f),y=O(d);Ct(y),_t(2),A(d);var v=T(d,2),b=O(v);b.__click=[zt,r,t];var l=T(b,2);l.__click=[Vt,s,t,a];var u=T(l,2),_=O(u);A(u),A(v),A(f),A(g);var m=T(g,2);{var w=S=>{var E=Ie(),c=Y(E);At(c,17,()=>t.steps,Rt,(h,I,F)=>{var L=Ht(),C=Y(L),R=O(C);A(C);var x=T(C,2),U=O(x);be(U,()=>M(I).description),A(x);var X=T(x,2);le(X,J=>{}),re(()=>ae(R,`Step #${F+1}: ${M(I).title??""}`)),V(h,L)}),V(S,E)},N=S=>{var E=Ie(),c=Y(E);{var h=I=>{const F=Et(()=>t.steps[t.stepIndex]);var L=Bt(),C=Y(L),R=O(C);A(C);var x=T(C,2),U=O(x);be(U,()=>M(F).description),A(x),re(()=>ae(R,`Step #${t.stepIndex+1}: ${M(F).title??""}`)),V(I,L)};le(c,I=>{t.stepIndex<t.steps.length&&I(h)})}V(S,E)};le(m,S=>{M(i)?S(w):S(N,!1)})}A(o),re(()=>{Ft(o,`padding-left: ${n()*100}px; border: solid black 1px`),ae(_,`${t.stepIndex+1}/${a??""}`)}),Pt(y,()=>M(i),S=>pt(i,S)),V(e,o),mt()}wt(["click"]);var Gt=ee('<main><div class="loading svelte-nrcxd8"><span class="spinner svelte-nrcxd8"></span> <span><!></span></div></main>');function ms(e,t){var n=Gt(),s=O(n),r=T(O(s),2),a=O(r);bt(a,()=>t.children),A(r),A(s),A(n),V(e,n)}function Es(e,t,n={serialize:s=>p.serialize(s),revive:s=>p.revive(s)}){let s=K(t);yt(()=>{const a=localStorage.getItem(e);if(a){const i=n.revive(JSON.parse(a));s.set(i)}});const r=()=>{if(we(s)){const a=JSON.stringify(n.serialize(we(s)));localStorage.setItem(e,a)}else localStorage.removeItem(e)};return{value:s,save:()=>r()}}var Z=(e=>(e.UNSOLVABLE="unsolvable",e.RESULT="result",e.ERROR="error",e))(Z||{});function Is(e){let t=e.storage.value,n=K(!1),s=K(!1),r=K(""),a=null,i=null,o=null,g=!1;t.subscribe(v=>{g=v.hasOutCertificate(),i=v.inInstance,o=v.outInstance});function f(v){console.debug("editorChanged"),a&&(a.terminate(),a=null,s.set(!1),r.set("Solving cancelled.")),t.update(b=>(b.reset(),b.setInInstance(v),b)),e.storage.save()}function d(){if(!i||i.isEmpty())return;const v=e.reducerFactory(i),{outInstance:b,steps:l}=v.reduce();t.update(u=>(u.setSteps(l),u.setOutInstance(b),u)),e.storage.save()}async function y(){if(console.debug("useReductionController::solve()"),!e.workerFactory)throw console.debug("workerFactory was not provided"),new Error("workerFactory was not provided");if(!o)throw console.debug("Output instance is not set"),new Error("Output instance is not set");if(g)throw console.debug("Reduction storage already has certificate of the output problem"),new Error("Reduction storage already has certificate of the output problem");s.set(!0),r.set("Solving..."),a&&a.terminate(),console.debug("creating new worker...");const v=e.workerFactory();a=v,console.debug("new worker created"),console.debug("creating worker message...");const b=e.createWorkerRequest?.(o)??o.toSerializedString();console.debug("posting  worker message..."),v.postMessage(b);try{console.debug("awaiting result...");const l=await new Promise((u,_)=>{v.onmessage=m=>{const w=m.data;switch(console.debug("worker responded with data",w),w.type){case Z.UNSOLVABLE:u(Se);break;case Z.ERROR:u(w.message);break;case Z.RESULT:u(e.resolveWorkerResponse(w));break}},v.onerror=m=>_(m)});console.debug("worker's result",l),console.debug("updating reduction store..."),t.update(u=>{if(u.outCert=l,l!=Se){console.debug("creating decoder factory...");const _=e.decoderFactory();console.debug("decoding..."),u.inCert=_.decode(u.outInstance,l)}return u}),console.debug("calling onSolveFinished callback..."),e.onSolveFinished?.(o,l),console.debug("saving to local storage..."),e.storage.save(),console.debug("unset the solve message..."),r.set(""),console.debug("success")}catch(l){console.error("Error occured while solving:",l),r.set(`Error occured while solving: ${l}`)}finally{s.set(!1),v.terminate(),a=null}}return St(()=>{a&&(a.terminate(),a=null)}),It(()=>{t.update(v=>(v.resetStepIndex(),v))}),{redStore:t,showStepper:n,isSolving:s,solveMessage:r,editorChanged:f,reduce:d,solve:y}}class ws{constructor(t){this.inInstance=t}reduce(){if(this.inInstance.isEmpty())throw"Call to reduce failed. Input instance is empty.";return this.doReduce()}}var $t=Object.getOwnPropertyDescriptor,Wt=(e,t,n,s)=>{for(var r=s>1?void 0:s?$t(t,n):t,a=e.length-1,i;a>=0;a--)(i=e[a])&&(r=i(r)||r);return r};let Re=class{inInstance=null;outInstance=null;steps=[];stepIndex=0;inCert=null;outCert=null;reset(){this.inInstance=null,this.outInstance=null,this.inCert=null,this.outCert=null,this.steps=[],this.stepIndex=0}resetStepIndex(){this.stepIndex=0}setInInstance(e){this.reset(),this.inInstance=e}setOutInstance(e){this.outInstance=e}setSteps(e){this.steps=e,this.stepIndex=0}nextStep(){const e=this.steps.length;this.stepIndex=Math.min(this.stepIndex+1,e)}prevStep(){this.stepIndex=Math.max(this.stepIndex-1,0)}hasInstances(){return this.inInstance!=null&&this.outInstance!=null}hasInInstance(){return this.inInstance!=null}hasOutInstance(){return this.outInstance!=null}hasInCertificate(){return this.inCert!=null}hasOutCertificate(){return this.outCert!=null}};Re=Wt([p.SerializableClass("ReductionStore")],Re);export{W as C,he as D,ue as E,H as G,gs as H,cs as N,ze as P,ws as R,p as S,is as T,Se as U,us as V,Z as W,ns as a,Pt as b,ss as c,ds as d,At as e,ls as f,k as g,rs as h,Rt as i,as as j,os as k,Re as l,Is as m,Ue as n,ms as o,ps as p,_s as q,Ce as r,es as s,ts as t,Es as u,fs as v,vs as w,hs as x};
